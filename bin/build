#!/usr/bin/env bash
set -euo pipefail
IFS=$'\n\t'

version="1.0.0.beta2"
locale="en"

main() {
  # install_hanami
  generate_docs
}

install_hanami() {
  local target="vendor"

  echo "Installing Hanami $version"

  if [ -d $target ]; then
    rm -rf $target
  fi

  gem install --prerelease --force --install-dir=$target hanami hanami-model $version
}

generate_docs() {
  local sources="vendor/gems/hanami*/lib/**/*"
  local title="Hanami Docs $version"

  # yardoc
  #   --no-cache \ # Don't use cache
  #   --no-save  \ # Don't write cache
  #   # --protected \ # Include Ruby protected methods
  #   # --private \ # Include Ruby private methods
  #   # --no-private \ # Exclude methods with @api private
  #   # --title="$title" \ # HTML page title
  #   vendor/gems/hanami*/lib/**/*
  yardoc --no-cache --no-save --protected --private --no-api private --markup markdown --locale=$locale --title="$title" vendor/gems/hanami*/lib/**/*
}

main
